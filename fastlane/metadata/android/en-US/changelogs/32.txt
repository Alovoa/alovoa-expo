Several UI and bug fixes